Tested on MacOS 10.11.1 (clang-700.1.81) and Ubuntu 14.04.2 (gcc 4.9.3) 